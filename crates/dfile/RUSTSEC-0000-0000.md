```toml
[advisory]
id = "RUSTSEC-0000-0000"
package = "dfile"
date = "2023-01-20"
url = "https://gitlab.com/Danno131313/dfile-rs/-/issues/1"
cvss = "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N"
keywords = ["ssh", "mitm"]

[affected]
functions = { "dfile::commands::try_clone" = ["<= 1.3.6"],"dfile::commands::git_update" = ["<= 1.3.6"] }

[versions]
patched = []
```

# MITM attack possible due to missing host-key verification

This crate doesn't verify the host-id of the git server that it interacts with, and is thus vulnerable to MITM attacks.

At worst I fear that this might lead to remote code execution, as the program interacts with users dot files, which are executed on user login.

Reproduction:

```
capitol@phoenix:~/projects/dfile-rs$ cat /etc/hosts
127.0.0.1 github.com
capitol@phoenix:~/projects/dfile-rs$ DOTFILE_PATH=/tmp/dot PRIMARY_SSH_KEY=/home/capitol/.ssh/id_rsa ./target/debug/dfile list
No repository found at $DOTFILE_PATH.
Would you like to clone a repo? (y/n): y
What is the SSH clone url?: capitol@github.com:/tmp/dot-server/
Repo has been successfully cloned. Run 'dfile restore' to restore all files.
```
